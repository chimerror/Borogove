version: 0.0.{build}

environment:
  BorogoveConnectionString:
    secure: K8/pTD62RotAYEX0tM/+ea4DmRV8zvkP2/Gl1TYot7Wgtl3nQNrIVCOOiIPuQ/4PHiHVsSIyNeWRytfCk5IVVsLXRF0eTG1JeoQO92q2UseHutXASsOArfIdZ3zAH8RxdXYYfaGIcEXGvA3rZL50YohG+ikhRNGRg3MktGU3IKrej3zl/UxNJy/e+8JAK2eQTdrbZ+rPtg2+ILy8P+WwEFqZFHJgTFg4qKakTJFqh5Uwzyuz5U7UU9OsanB5xzBmAPMTtkZQAGpQ8LOaz4mQjw==

install:
  - mkdir ..\Wyam
  - mkdir ..\Output
  # Fetch the latest version of Wyam
  - "curl -s https://raw.githubusercontent.com/Wyamio/Wyam/master/RELEASE -o ..\\Wyam\\wyamversion.txt"
  - set /P WYAMVERSION=< ..\Wyam\wyamversion.txt
  - echo %WYAMVERSION%
  # Get and unzip the latest version of Wyam
  - ps: Start-FileDownload "https://github.com/Wyamio/Wyam/releases/download/$env:WYAMVERSION/Wyam-$env:WYAMVERSION.zip" -FileName "..\Wyam\Wyam.zip"
  - 7z x ..\Wyam\Wyam.zip -o..\Wyam -r

before_build:
  - nuget restore

after_build:
  - ..\Wyam\Wyam.exe Borogove.TestSite --output ..\Output
  - dir Output

artifacts:
  - path: Output
    name: wyam output
    type: zip
